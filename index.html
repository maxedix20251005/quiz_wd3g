<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ウェブデザイン技能検定3級過去問</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="app-header">
    <div class="container">
      <h1>ウェブデザイン技能検定3級過去問</h1>
      <p class="sub">年代順 / ランダム / タイプ別で25問ずつ出題（オフライン対応）</p>
      <p class="sub"><strong>重要:</strong> ファイル直開き（file://）でも動くように改善済み。PDF→データ化は tools を使用。</p>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h2>出題設定</h2>

      <div class="grid">
        <label class="field">
          <span>モード</span>
          <select id="mode">
            <option value="chronological">年代順（古い→新しい）</option>
            <option value="random">ランダム</option>
            <option value="byType">タイプ別</option>
          </select>
        </label>

        <label class="field" id="typeField" hidden>
          <span>タイプ</span>
          <select id="typeSelect">
            <option value="tf">○×</option>
            <option value="mc">四択</option>
            <option value="all">全て</option>
          </select>
        </label>

        <label class="field">
          <span>問題数</span>
          <select id="count">
            <option value="25" selected>25</option>
            <option value="10">10</option>
            <option value="50">50</option>
          </select>
        </label>
        <label class="field">
          <span>回（R07）</span>
          <select id="examSelect">
            <option value="all" selected>全て</option>
            <option value="R07-1-3_gakka_open">R07-1-3</option>
            <option value="R07-2-3_gakka_open">R07-2-3</option>
            <option value="R07-3-3_gakka_open">R07-3-3</option>
          </select>
        </label>


        <label class="field">
          <span>データ</span>
          <select id="dataset">
            <option value="__embedded__">サンプル（同梱・埋め込み）</option>
            <option value="__r07__" selected>R07（添付PDFから自動生成・75問）</option>
          </select>
        </label>
      </div>

      <div class="row">
        <button id="startBtn" class="primary">開始</button>
        <button id="importBtn">JSONを読み込む</button>
        <input id="fileInput" type="file" accept="application/json" hidden />
        <button id="exportBtn" class="ghost">成績をエクスポート</button>
        <button id="resetBtn" class="ghost">リセット</button>
      </div>

      <details class="note">
        <summary>PDFをそのまま読み込んで出題できますか？（結論）</summary>
        <ul>
          <li><strong>ブラウザだけでPDFを解析して「設問＋選択肢＋正答＋解説」を自動生成</strong>するのは難易度が高いため、現段階では<strong>同梱ツールでPDF→JSON+画像に自動変換</strong>して使う方式です。</li>
          <li>図・表・レイアウトを欠落させないため、設問は基本<strong>画像（切り出し）</strong>で保持します。</li>
          <li>運用は「PDFをフォルダに置く → ツール実行 → 生成された data/questions.json を読み込む」です（手入力は不要）。</li>
        </ul>
      </details>
    </section>

    <section id="quiz" class="card" hidden>
      <div class="quiz-top">
        <div>
          <h2 id="quizTitle">出題中</h2>
          <p class="sub" id="quizMeta"></p>
        </div>
        <div class="quiz-progress">
          <div class="bar"><div id="barFill"></div></div>
          <div class="sub" id="progressText"></div>
        </div>
      </div>

      <article id="questionCard" class="qcard"></article>

      <div class="row">
        <button id="prevBtn" class="ghost">戻る</button>
        <button id="nextBtn" class="primary">次へ</button>
        <button id="finishBtn" class="danger" hidden>終了して結果を見る</button>
      </div>
    </section>

    <section id="result" class="card" hidden>
      <h2>結果</h2>
      <div class="result-summary">
        <div class="kpi">
          <div class="kpi-label">正答数</div>
          <div class="kpi-value" id="kpiCorrect">-</div>
        </div>
        <div class="kpi">
          <div class="kpi-label">正答率</div>
          <div class="kpi-value" id="kpiRate">-</div>
        </div>
        <div class="kpi">
          <div class="kpi-label">弱点タグ</div>
          <div class="kpi-value" id="kpiWeak">-</div>
        </div>
      </div>

      <div class="row">
        <button id="reviewBtn" class="primary">復習（誤答のみ）</button>
        <button id="backToTopBtn" class="ghost">トップへ</button>
      </div>

      <h3>解答・解説（誤答には原因と克服アドバイス）</h3>
      <div id="resultList" class="result-list"></div>
    </section>

    <footer class="footer">
      <p class="sub">※進捗/履歴は端末内（localStorage）に保存。共有は GitHub Pages / Cloudflare Pages 等に配置してURL共有が低コスト。</p>
    </footer>
  </main>

  <script src="./app.js" defer></script>
</body>
</html>
